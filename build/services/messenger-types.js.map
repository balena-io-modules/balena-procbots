{"version":3,"sources":["services/messenger-types.ts"],"names":[],"mappings":";;AA2CA,IAAY,eAEX;AAFD,WAAY,eAAe;IAC1B,yDAAM,CAAA;AACP,CAAC,EAFW,eAAe,GAAf,uBAAe,KAAf,uBAAe,QAE1B","file":"messenger-types.js","sourcesContent":["/*\n Copyright 2016-2017 Resin.io\n\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n */\n\nimport * as Promise from 'bluebird';\n\nimport {\n\tWorkerEvent,\n} from '../framework/worker';\nimport {\n\tServiceEmitContext,\n\tServiceEmitResponse,\n\tServiceEvent,\n} from './service-types';\n\n/** A standardised form of ServiceEvent that allows for common tasks to benefit from recycled code. */\nexport interface MessengerEvent extends ServiceEvent {\n\tcookedEvent: {\n\t\tcontext: string;\n\t\ttype: string;\n\t\t[key: string]: any;\n\t};\n\trawEvent: any;\n\tsource: string;\n}\n/** A standardised form of WorkerEvent that allows for common tasks to benefit from recycled code. */\nexport interface MessengerWorkerEvent extends WorkerEvent {\n\tdata: MessengerEvent;\n}\n\n/** An enum of the events types that a messenger service may understand */\nexport enum MessengerAction {\n\tCreate,\n}\n\n/** The IDs that a message may provide */\nexport interface MessengerIds {\n\tuser?: string;\n\tmessage?: string;\n\tthread?: string;\n\ttoken?: string;\n\tflow?: string;\n\turl?: string;\n}\n/** The data structure that a message must provide */\nexport interface MessengerContext {\n\taction: MessengerAction;\n\tfirst: boolean;\n\tgenesis: string;\n\thidden: boolean;\n\tsource: string;\n\tsourceIds?: MessengerIds;\n\ttext: string;\n\ttitle?: string;\n}\n\n/** The IDs expected of a message when received */\nexport interface ReceiptIds extends MessengerIds {\n\tuser: string;\n\tmessage: string;\n\tthread: string;\n\tflow: string;\n}\n/** The data structure expected of a message when received */\nexport interface ReceiptContext extends MessengerContext {\n\tsourceIds: ReceiptIds;\n}\n\n/** The data structure that deals with a message as it passes through the system */\nexport interface InterimContext extends MessengerContext {\n\tsourceIds: ReceiptIds;\n\tto: string;\n\ttoIds: MessengerIds;\n}\n\n/** The IDs expected of a message once it is ready for transmission */\nexport interface TransmitIds extends MessengerIds {\n\tuser: string;\n\ttoken: string;\n\tflow: string;\n}\n/** The context expected of a message once it is ready for transmission */\nexport interface TransmitContext extends MessengerContext {\n\tsourceIds: ReceiptIds;\n\tto: string;\n\ttoIds: TransmitIds;\n}\n\n/** A more specific form of EmitContext that sets a common expectation when emitting a message. */\nexport interface MessengerEmitContext extends ServiceEmitContext {\n\tendpoint: object;\n\tmeta?: any;\n\tpayload: object;\n}\n\n/** A more specific form of EmitResponse that contains data in a message orientated fashion. */\nexport interface MessengerEmitResponse extends ServiceEmitResponse {\n\tresponse?: {\n\t\tmessage: string;\n\t\tthread: string;\n\t\turl?: string;\n\t};\n}\n\n/** String options that may be used in metadata to indicate if a comment is public. */\nexport interface PublicityIndicator {\n\temoji: string;\n\tword: string;\n\tchar: string;\n}\n\n/** Standard set of data that is required alongside the message. */\nexport interface Metadata {\n\tgenesis: string | null;\n\thidden: boolean;\n\tcontent: string;\n}\n\n/** Information that allows us to target a flow, for example in pairing equivalent flows. */\nexport interface FlowDefinition {\n\tservice: string;\n\tflow: string;\n}\n\n/** A definition for a service that allows the retrieval of user-set values. */\nexport interface DataHub {\n\t/**\n\t * Retrieve a value that a user has set.\n\t * @param user   The user who's data set we wish to search.\n\t * @param value  This should be 'key'.  It is the data we wish to search for.\n\t */\n\tfetchValue(user: string, value: string): Promise<string>;\n}\n"],"sourceRoot":"../../lib"}