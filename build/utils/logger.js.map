{"version":3,"sources":["utils/logger.ts"],"names":[],"mappings":";;AA0BA,IAAY,QAOX;AAPD,WAAY,QAAQ;IAEhB,uCAAQ,CAAA;IAER,uCAAI,CAAA;IAEJ,yCAAK,CAAA;AACT,CAAC,EAPW,QAAQ,GAAR,gBAAQ,KAAR,gBAAQ,QAOnB;AAAA,CAAC;AASF,IAAY,UAKX;AALD,WAAY,UAAU;IAElB,mDAAY,CAAA;IAEZ,6CAAK,CAAA;AACT,CAAC,EALW,UAAU,GAAV,kBAAU,KAAV,kBAAU,QAKrB;AAAA,CAAC;AAMF;IAAA;QAGY,cAAS,GAAI,OAAO,CAAC,GAAG,CAAC,iBAAiB,IAAI,QAAQ,CAAC,IAAI,CAAC;QAC5D,gBAAW,GAAG,OAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI,UAAU,CAAC,KAAK,CAAC;QAGlE,oBAAe,GAAG;YACtB,SAAS;YACT,MAAM;YACN,OAAO;SACV,CAAC;QAGM,sBAAiB,GAAG;YACxB,UAAU;YACV,OAAO;SACV,CAAC;IA0DN,CAAC;IApDG,IAAW,QAAQ;QACf,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;IAC1B,CAAC;IAMD,IAAW,QAAQ,CAAC,KAAe;QAC/B,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;IAC3B,CAAC;IAMD,IAAW,UAAU;QACjB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;IAC5B,CAAC;IAMD,IAAW,UAAU,CAAC,KAAiB;QACnC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;IAC7B,CAAC;IAOM,GAAG,CAAC,KAAa,EAAE,OAAe;QACrC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,eAAe,EAAE,OAAO,CAAC,CAAC;IACtE,CAAC;IAOM,KAAK,CAAC,KAAa,EAAE,OAAe;QACvC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;IAC1E,CAAC;IAGO,MAAM,CAAC,KAAa,EAAE,UAAkB,EAAE,YAAsB,EAAE,OAAe;QACrF,EAAE,CAAC,CAAC,KAAK,IAAI,UAAU,CAAC,CAAC,CAAC;YACtB,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,KAAK,YAAY,CAAC,KAAK,CAAC,MAAM,OAAO,EAAE,CAAC,CAAC;QACpF,CAAC;IACL,CAAC;CACJ;AA3ED,wBA2EC","file":"logger.js","sourcesContent":["/*\nCopyright 2016-2017 Resin.io\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n// This is class and not a module as it allows different clients to change their\n// log level without affecting the rest of the system.\n\n/**\n * Logging levels are stacked, with a chosen logging level also triggering all\n * levels below it; choosing a logging level of DEBUG will cause all DEBUG,\n * INFO & WARN levels to be output, choosing a logging level of WARN will only cause\n * WARN levels to be output.\n * They are arranged this way to allow additional items to be added if required.\n */\nexport enum LogLevel {\n    /** Warning level. */\n    WARN = 0,\n    /** Information level. Includes WARN level. */\n    INFO,\n    /** Debug level. Includes INFO and WARN level. */\n    DEBUG\n};\n\n/**\n * Alerting levels are stacked, with a chosen alerting level also triggering all\n * levels below it; choosing an alerting level of ERROR will cause both\n * ERROR & CRITICAL output to be sent to the alert system; choosing CRITICAL will only\n * output CRITICAL errors to the alert system.\n * They are arranged this way to allow additional items to be added if required.\n */\nexport enum AlertLevel {\n    /** Critical alert level. */\n    CRITICAL = 0,\n    /** Error level. Includes CRITICAL level. */\n    ERROR\n};\n\n/**\n * The Logger class allows output from the bots and services to any useful medium.\n * Currently the only output is of that to the console.\n */\nexport class Logger {\n    // Log and Alert levels are taken from an envvar or set to the minimum.\n    // These can be overriden by specific methods.\n    private _logLevel =  process.env.PROCBOT_LOG_LEVEL || LogLevel.WARN;\n    private _alertLevel = process.env.PROCBOT_ALERT_LEVEL || AlertLevel.ERROR;\n\n    /** Strings prepended to logging output. */\n    private logLevelStrings = [\n        'WARNING',\n        'INFO',\n        'DEBUG'\n    ];\n\n    /** Strings prepended to alerting output. */\n    private alertLevelStrings = [\n        'CRITICAL',\n        'ERROR'\n    ];\n\n    /**\n     * Get the logging level.\n     * @return  Current logging level.\n     */\n    public get logLevel(): LogLevel {\n        return this._logLevel;\n    }\n\n    /**\n     * Set logging evel.\n     * @param level Logging level to use.\n     */\n    public set logLevel(level: LogLevel) {\n        this._logLevel = level;\n    }\n\n    /**\n     * Get the alert level.\n     * @return  Current alerting level.\n     */\n    public get alertLevel(): AlertLevel {\n        return this._alertLevel;\n    }\n\n    /**\n     * Set alert level.\n     * @param level Alerting level to use.\n     */\n    public set alertLevel(level: AlertLevel) {\n        this._alertLevel = level;\n    }\n\n    /**\n     * Log output.\n     * @param level     The level that this message is of (INFO, etc.).\n     * @param message   The actual log message.\n     */\n    public log(level: number, message: string): void {\n        this.output(level, this._logLevel, this.logLevelStrings, message);\n    }\n\n    /**\n     * Alert output.\n     * @param level     The level that this message is of (ERROR, etc.).\n     * @param message   The actual alert message.\n     */\n    public alert(level: number, message: string): void {\n        this.output(level, this._alertLevel, this.alertLevelStrings, message);\n    }\n\n    // Generic output method for either type.\n    private output(level: number, classLevel: number, levelStrings: string[], message: string): void {\n        if (level >= classLevel) {\n            console.log(`${new Date().toISOString()}: ${levelStrings[level]} - ${message}`);\n        }\n    }\n}\n"],"sourceRoot":"../../lib"}